<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Laboratório de Calíope</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v5.0.0/dist/aframe-physics-system.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
        }

        .a-scene {
            height: 100vh;
            width: 100vw;
        }
    </style>
</head>

<body>
    <a-scene physics="gravity: -9.8">
        <!-- Assets para pré-carregamento -->
        <a-assets>
            <img id="metalFloor" src="https://cdn.glitch.global/039c2874-5c50-4d87-8f5b-6101c513233c/metal_texture.jpg"
                crossorigin="anonymous">
            <img id="wallTexture"
                src="https://cdn.glitch.global/039c2874-5c50-4d87-8f5b-6101c513233c/concrete_texture.jpg"
                crossorigin="anonymous">
            <audio id="labAmbience"
                src="https://cdn.glitch.global/039c2874-5c50-4d87-8f5b-6101c513233c/sci-fi-lab-ambience.mp3"
                preload="auto"></audio>
            <audio id="blip" src="https://cdn.glitch.global/039c2874-5c50-4d87-8f5b-6101c513233c/blip.wav"
                preload="auto"></audio>
            <!-- Nova imagem para o interior da cápsula -->
            <img id="insideImage" src="Imagem colada.jpg" crossorigin="anonymous">
            <!-- Imagens para o novo painel de controle de defesa -->
            <img id="artemis-image" src="/img/Artemis.png" crossorigin="anonymous">
            <img id="harpias-image" src="/img/Harpias.jpg" crossorigin="anonymous">
            <img id="minos-image" src="/img/Minos.jpg" crossorigin="anonymous">
        </a-assets>

        <!-- Componente customizado para o terminal -->
        <script>
            // Lógica para o terminal
            AFRAME.registerComponent('terminal-logic', {
                init: function () {
                    const el = this.el;
                    const terminalTextEl = document.querySelector('#terminalText');
                    let currentParagraph = -1;
                    const paragraphs = [
                        "Projeto Calíope — Relatório de Desenvolvimento",
                        "A unidade Calíope é um protótipo de robô humanoide desenvolvido no Instituto Helios, cujo objetivo principal é a integração entre sistemas de inteligência artificial adaptativa e módulos de aprendizado contínuo.",
                        "A concepção do projeto busca explorar três áreas fundamentais:",
                        "Processamento Cognitivo Avançado – Implementação de redes neurais artificiais capazes de reconfiguração dinâmica, permitindo à unidade responder a ambientes imprevistos.",
                        "Integração Sensorial Multimodal – Conjunto de sensores visuais, táteis e auditivos projetados para coleta de dados em tempo real, facilitando processos de análise contextual.",
                        "Aprimoramento Progressivo de Habilidades – Estrutura modular que possibilita a instalação gradual de novos conhecimentos e funções, simulando um processo de evolução cognitiva.",
                        "O nome Calíope foi atribuído em referência à musa da eloquência e da poesia épica da mitologia grega, simbolizando a união entre racionalidade tecnológica e criatividade humana.",
                        "No estágio atual, a unidade encontra-se em fase de testes laboratoriais, restrita ao ambiente controlado do instituto. O próximo passo será validar sua capacidade de interação com sistemas externos e resolução de problemas complexos em cenários simulados."
                    ];

                    el.addEventListener('click', () => {
                        el.emit('blip-sound');
                        currentParagraph = (currentParagraph + 1) % (paragraphs.length + 1);
                        if (currentParagraph === paragraphs.length) {
                            terminalTextEl.setAttribute('value', "> Terminal Ativo\nClique para Acessar Relatório");
                            terminalTextEl.setAttribute('scale', "0.8 0.8 0.8");
                            terminalTextEl.setAttribute('width', "1.5");
                            terminalTextEl.setAttribute('align', "center");
                            currentParagraph = -1;
                        } else {
                            // Mostra apenas o parágrafo atual
                            terminalTextEl.setAttribute('value', paragraphs[currentParagraph]);
                            terminalTextEl.setAttribute('scale', "0.4 0.4 0.4");
                            terminalTextEl.setAttribute('width', "3");
                            terminalTextEl.setAttribute('align', "center");
                        }
                    });
                }
            });

            // Componente customizado para botões
            AFRAME.registerComponent('button-logic', {
                init: function () {
                    const el = this.el;
                    const originalColor = el.getAttribute('color');
                    el.addEventListener('click', () => {
                        el.emit('blip-sound');
                        el.setAttribute('color', '#ff0000');
                        setTimeout(() => {
                            el.setAttribute('color', originalColor);
                        }, 200);
                    });
                }
            });

            // Componente para animação de texto binário
            AFRAME.registerComponent('binary-text-animator', {
                schema: {
                    length: {
                        type: 'int',
                        default: 12
                    },
                    interval: {
                        type: 'int',
                        default: 100
                    }
                },
                init: function () {
                    this.updateText = this.updateText.bind(this);
                    this.intervalId = setInterval(this.updateText, this.data.interval);
                },
                updateText: function () {
                    let binaryString = "";
                    for (let i = 0; i < this.data.length; i++) {
                        binaryString += Math.round(Math.random());
                    }
                    this.el.setAttribute('value', binaryString);
                },
                remove: function () {
                    clearInterval(this.intervalId);
                }
            });

            // Componente para lógica do painel de diagnóstico
            AFRAME.registerComponent('diagnostico-logic', {
                init: function () {
                    const el = this.el;
                    const textEl = el.querySelector('#diagnosticoText');
                    const diagnosticoParagraphs = [
                        "O Instituto Helios é um centro de pesquisa avançada dedicado ao desenvolvimento de tecnologias emergentes em inteligência artificial, robótica e sistemas distribuídos. Fundado com o objetivo de expandir os limites do conhecimento humano, o instituto atua em projetos que combinam inovação tecnológica com impacto social e científico.",
                        "Sua estrutura conta com laboratórios de última geração, onde equipes multidisciplinares trabalham na criação de protótipos inteligentes, simulações em realidade virtual e integração entre máquinas e humanos. Esses ambientes controlados permitem testar conceitos em condições seguras e progressivamente mais complexas.",
                        "O instituto também é responsável pela formação de novas gerações de cientistas e engenheiros, fomentando a colaboração entre áreas como ciência da computação, engenharia elétrica, biotecnologia e filosofia da tecnologia. Mais do que criar máquinas, o Instituto Helios busca compreender e redefinir a relação entre humanidade, conhecimento e inovação."
                    ];
                    let currentParagraph = -1;

                    el.addEventListener('click', () => {
                        el.emit('blip-sound');
                        currentParagraph = (currentParagraph + 1) % (diagnosticoParagraphs.length + 1);
                        if (currentParagraph === diagnosticoParagraphs.length) {
                            textEl.setAttribute('value', "Instituto Helios");
                            textEl.setAttribute('scale', "2 2 2");
                            textEl.setAttribute('width', "auto");
                            textEl.setAttribute('align', "center");
                            currentParagraph = -1;
                        } else {
                            textEl.setAttribute('value', diagnosticoParagraphs[currentParagraph]);
                            textEl.setAttribute('scale', "0.8 0.8 0.8");
                            textEl.setAttribute('width', "4");
                            textEl.setAttribute('align', "center");
                        }
                    });
                }
            });

            // Novo componente para o painel de defesa
            AFRAME.registerComponent('defense-panel-logic', {
                init: function () {
                    const panel = this.el;
                    const imagePlane = panel.querySelector('#defenseImage');
                    const captionText = panel.querySelector('#defenseCaption');

                    panel.querySelectorAll('.defense-button').forEach(button => {
                        button.addEventListener('click', (evt) => {
                            evt.stopPropagation(); // Evita que o evento de clique se propague para outros elementos
                            const buttonId = button.id;
                            let imageSrc = '';
                            let caption = '';

                            switch (buttonId) {
                                case 'button1':
                                    imageSrc = '#artemis-image';
                                    caption = 'Drone de defesa Ártemis';
                                    break;
                                case 'button2':
                                    imageSrc = '#harpias-image';
                                    caption = 'Drone de Combate Harpias';
                                    break;
                                case 'button3':
                                    imageSrc = '#minos-image';
                                    caption = 'Agente Robótico de IA Minos (último recurso)';
                                    break;
                            }

                            imagePlane.setAttribute('src', imageSrc);
                            captionText.setAttribute('value', caption);

                            panel.emit('blip-sound');
                        });
                    });
                }
            });
        </script>

        <!-- Ambiente e iluminação -->
        <a-entity light="type: ambient; intensity: 0.2; color: #4f6487"></a-entity>
        <a-entity light="type: point; intensity: 15; distance: 10; color: #94c6ff" position="0 5 -5"
            animation="property: light.intensity; from: 0; to: 15; delay: 1500; dur: 1000"></a-entity>
        <a-entity light="type: point; intensity: 10; distance: 15; color: #94c6ff" position="0 5 5"
            animation="property: light.intensity; from: 0; to: 10; delay: 2000; dur: 1000"></a-entity>


        <!-- Piso com textura -->
        <a-plane rotation="-90 0 0" width="20" height="20" src="#metalFloor" material="metalness: 0.8; roughness: 0.3"
            static-body></a-plane>

        <!-- Paredes com textura -->
        <a-box position="0 2.5 -10" depth="0.2" height="5" width="20" src="#wallTexture" static-body></a-box>
        <a-box position="0 2.5 10" depth="0.2" height="5" width="20" src="#wallTexture" static-body></a-box>
        <a-box position="-10 2.5 0" depth="20" height="5" width="0.2" src="#wallTexture" static-body></a-box>
        <a-box position="10 2.5 0" depth="20" height="5" width="0.2" src="#wallTexture" static-body></a-box>

        <!-- Teto -->
        <a-plane position="0 5 0" rotation="90 0 0" width="20" height="20" color="#cfcfcf" static-body></a-plane>

        <!-- Bancadas e computadores -->
        <a-box position="-6 0.5 -6" depth="2" height="1" width="3" color="#1a1a1a" static-body></a-box>
        <a-box position="6 0.5 -6" depth="2" height="1" width="3" color="#1a1a1a" static-body></a-box>
        <a-box position="-6 0.5 6" depth="2" height="1" width="3" color="#1a1a1a" static-body></a-box>
        <a-box position="6 0.5 6" depth="2" height="1" width="3" color="#1a1a1a" static-body></a-box>

        <!-- Computadores -->
        <a-box position="-6 1.3 -6" depth="0.2" height="1" width="1.5" color="#000"></a-box>
        <a-box position="-6 0.8 -5.8" depth="0.5" height="0.5" width="0.5" color="#000"></a-box>
        <a-box position="6 1.3 -6" depth="0.2" height="1" width="1.5" color="#000"></a-box>
        <a-box position="6 0.8 -5.8" depth="0.5" height="0.5" width="0.5" color="#000"></a-box>
        <a-box position="-6 1.3 6" depth="0.2" height="1" width="1.5" color="#000"></a-box>
        <a-box position="-6 0.8 6.2" depth="0.5" height="0.5" width="0.5" color="#000"></a-box>
        <a-box position="6 1.3 6" depth="0.2" height="1" width="1.5" color="#000"></a-box>
        <a-box position="6 0.8 6.2" depth="0.5" height="0.5" width="0.5" color="#000"></a-box>

        <!-- Painel de controle holográfico -->
        <a-entity position="0 1.2 -9.0" defense-panel-logic>
            <a-box depth="0.2" height="1.8" width="3" color="#00e5ff" opacity="0.2" static-body></a-box>
            <a-plane width="3" height="1.8" color="#00e5ff" opacity="0.1" position="0 0 0.1"
                animation="property: opacity; from: 0.1; to: 0.15; loop: true; dir: alternate; dur: 1500;"></a-plane>
            <a-box id="button1" class="defense-button" position="-0.8 0.2 0.2" depth="0.2" height="0.3" width="0.2"
                color="#2ecc71" static-body></a-box>
            <a-box id="button2" class="defense-button" position="0 0.2 0.2" depth="0.2" height="0.3" width="0.3"
                color="#e74c3c" static-body></a-box>
            <a-box id="button3" class="defense-button" position="0.8 0.2 0.2" depth="0.2" height="0.3" width="0.3"
                color="#3498db" static-body></a-box>
            <a-text value="PAINEL DE DEFESA HOLOGRÁFICO" position="0 0.7 0.2" color="#00ffff" width="2.5"
                align="center"></a-text>
            <a-plane id="defenseImage" material="side: double; transparent: true" width="1.5" height="1"
                position="0 -0.4 0.2" opacity="0.8"></a-plane>
            <a-text id="defenseCaption" value="Clique nos botões para visualizar" position="0 -0.95 0.2" color="#00ff00"
                width="1.5" align="center"></a-text>
        </a-entity>

        <!-- Container da Cápsula da Calíope -->
        <a-entity position="0 2 -4">
            <!-- Cilindro externo (o tubo) -->
            <a-cylinder position="0 0 0" radius="1.2" height="4" color="#00e5ff" opacity="0.15" metalness="0.5"
                roughness="0.1"></a-cylinder>

            <!-- Cilindro interno (o líquido) -->
            <a-cylinder position="0 0.5 0" radius="1.1" height="3" color="#00aaff" opacity="0.8" metalness="0.8"
                roughness="0.1"
                animation__opacity="property: material.opacity; to: 0.9; loop: true; dir: alternate; dur: 2500;"
                animation__position="property: position; to: 0 0.4 0; loop: true; dir: alternate; dur: 3000;">
            </a-cylinder>

            <!-- Imagem flutuante dentro da cápsula -->
            <a-plane src="img/Caliope.png" material="side: double" width="1.5" height="1.5" position="0 0.5 0"
                rotation="0 0 0"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 15000; easing: linear;"></a-plane>

            <a-text value="Calíope em desenvolvimento" position="-0.2 2 1.5" color="#ffffff " width="6"
                align="center"></a-text>
        </a-entity>

        <!-- Novo Terminal interativo com aparência moderna -->
        <a-entity id="terminal-container" position="-0.75 1.4 -2.8" terminal-logic>
            <a-plane width="1.5" height="1.2" color="#000" opacity="0.5"
                animation__opacity="property: opacity; from: 0.5; to: 0.7; loop: true; dir: alternate; dur: 2000;"></a-plane>
            <a-plane width="1.5" height="1.2" color="#00ff00" opacity="0.1"
                animation="property: scale; from: 1 1 1; to: 1.1 1.1 1.1; loop: true; dir: alternate; dur: 3000;"></a-plane>
            <a-text id="terminalText" value="> Terminal Ativo\nClique para Acessar Relatório" color="#00ff00"
                position="0 0 0.05" scale="0.8 0.8 0.8" width="1.5" align="center"></a-text>
        </a-entity>

        <!-- Elementos de UI de anime flutuantes -->
        <a-entity position="0 2 8" scale="0.5 0.5 0.5" rotation="0 180 0" diagnostico-logic>
            <!-- Painel com animação, agora é o pai do texto -->
            <a-plane width="3" height="3" color="#00e5ff" opacity="0.1"
                animation="property: rotation; to: 0 40 0; loop: true; dir: alternate; dur: 5000;">
                <a-text id="diagnosticoText" value="Instituto Helios" color="#ffffff" position="0 0 0.2" align="center"
                    scale="2 2 2" width="auto"></a-text>
            </a-plane>

            <a-plane width="1.5" height="1.5" color="#00e5ff" opacity="0.2" position="0 0 0.1"></a-plane>
            <a-box width="0.2" height="0.2" depth="0.2" position="-0.75 0.75 0.2" color="#00ff00"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 2000;"></a-box>
        </a-entity>

        <a-entity position="-4 2 -4" scale="0.5 0.5 0.5" rotation="0 -45 0">
            <!-- PAINEL COM ANIMAÇÃO, AGORA É O PAI DO TEXTO BINÁRIO -->
            <a-plane width="3" height="3" color="#00e5ff" opacity="0.1"
                animation="property: rotation; to: 0 -40 0; loop: true; dir: alternate; dur: 5000;">
                <a-text id="binaryText" binary-text-animator="length: 12; interval: 100" color="#ffffff"
                    position="0 0 0.2" align="center" scale="1.5 1.5 1.5"></a-text>
            </a-plane>

            <a-plane width="1.5" height="1.5" color="#00e5ff" opacity="0.2" position="0 0 0.1"></a-plane>
            <a-box width="0.2" height="0.2" depth="0.2" position="0.75 -0.75 0.2" color="#00ff00"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 2000;"></a-box>
        </a-entity>


        <!-- Câmera com movimento e colisão -->
        <a-entity id="rig" position="0 1.6 5" kinematics-body>
            <a-entity camera look-controls wasd-controls="acceleration: 20">
                <a-cursor></a-cursor>
            </a-entity>
        </a-entity>

    </a-scene>
</body>

</html>